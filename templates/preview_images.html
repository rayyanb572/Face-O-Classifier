<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom Metadata -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preview Gambar "{{ folder_name }}"</title>

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">

    <link href="{{ url_for('static', filename='style.css') }}" rel="stylesheet">
</head>

<body>
    <!-- Navbar -->
    <nav class="navbar navbar-dark bg-primary fixed-top">
        <div class="container-fluid position-relative px-3">
            <button class="btn btn-outline-light position-absolute start-0 ms-3 py-1 px-2" onclick="goBack()">
                <i class="bi bi-arrow-left"></i><span class="ms-1"></span>
            </button>
            <span class="navbar-brand mb-0 w-100 text-center">{{ folder_name }}</span>
        </div>
    </nav>
    <div class="container mt-5 pt-4">
        <div class="row g-4">
            {% for image in images %}
            <div class="col-6 col-md-4 col-lg-3">
                <div class="image-grid-item" onclick="showModal('{{ image }}')">
                    <img src="{{ image }}" alt="Processed Image" class="img-fluid rounded shadow-sm">
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    <!-- Image Modal -->
    <div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-xl">
            <div class="modal-content bg-transparent border-0">
                <div class="modal-body text-center position-relative">
                    <button type="button" class="modal-back-btn" onclick="closeModal()">
                        <i class="bi bi-arrow-left"></i>
                    </button>
                    <img id="modalImage" class="modal-image img-fluid" src="" alt="Full Image">
                </div>
            </div>
        </div>
    </div>
    <!-- Bootstrap JS and Dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let currentModal = null;

        // Modal handling using Bootstrap's modal
        function goBack() {
            window.location.href = "{{ url_for('preview_folders') }}";
        }

        function showModal(src) {
            const modalImage = document.getElementById('modalImage');
            modalImage.src = src;
            const imageModalElement = document.getElementById('imageModal');
            currentModal = new bootstrap.Modal(imageModalElement);
            currentModal.show();
        }

        function closeModal() {
            if (currentModal) {
                currentModal.hide();
            }
        }

        // Close modal with Escape key
        document.addEventListener('keydown', function (event) {
            if (event.key === 'Escape') {
                closeModal();
            }
        });
    </script>
</body>

</html>